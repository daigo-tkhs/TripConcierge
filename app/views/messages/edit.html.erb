<%# Turbo Frame: 編集時はここだけ表示される %>
<%= turbo_frame_tag @message do %>
  <div class="flex justify-end w-full mb-2">
    <div class="w-full max-w-[80%] bg-white p-2 rounded-2xl border border-blue-300 shadow-sm">
      <%# ★修正: data: { turbo_frame: "_top" } を追加して、更新後にページ全体をリロードさせる %>
      <%= form_with(model: [@trip, @message], local: true, data: { turbo_frame: "_top" }) do |f| %>
        <div class="flex flex-col gap-2">
          <%= f.text_area :prompt, rows: 3, class: "w-full rounded-lg border-gray-200 shadow-inner focus:border-blue-500 focus:ring-blue-500 text-sm p-2 bg-gray-50" %>
          
          <div class="flex justify-end gap-2">
            <%# キャンセルボタン %>
            <%= link_to "キャンセル", trip_messages_path(@trip), class: "text-xs text-gray-500 hover:text-gray-700 py-1 px-2 flex items-center" %>
            
            <%= f.button type: "submit", class: "bg-blue-600 text-white text-xs font-bold py-1 px-3 rounded-lg hover:bg-blue-700 transition flex items-center gap-1" do %>
              更新
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>