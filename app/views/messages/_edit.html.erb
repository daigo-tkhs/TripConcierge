<%# app/views/messages/_edit.html.erb %>
<%= turbo_frame_tag dom_id(message) do %>
  <div class="flex justify-end mb-2 w-full">
    <div class="flex flex-col items-end max-w-[85%] w-full">
      <div class="bg-white p-3 rounded-2xl rounded-tr-none border border-blue-200 shadow-md w-full">
        <%# フォーム %>
        <%= form_with(model: [trip, message]) do |f| %>
          <div class="flex flex-col gap-2">
            <%= f.text_area :prompt, 
                rows: 3, 
                class: "w-full rounded-xl border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm p-3 resize-none",
                placeholder: "メッセージを編集...",
                onkeydown: "if((event.ctrlKey || event.metaKey) && event.key === 'Enter') { event.preventDefault(); this.form.requestSubmit(); }"
            %>
            <div class="flex justify-end items-center gap-3">
              <%# キャンセルも同じフレームをターゲットにする %>
              <%= link_to "キャンセル", trip_messages_path(trip, id: message.id), 
                  class: "text-xs text-gray-500 hover:text-gray-700 transition font-medium",
                  data: { turbo_frame: dom_id(message) } %>
              
              <%= f.button type: "submit", class: "bg-blue-600 text-white text-xs font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition shadow-sm flex items-center gap-1", data: { turbo_submits_with: "更新中..." } do %>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5">
                  <path d="m2.695 14.762-1.262 3.155a.5.5 0 0 0 .65.65l3.155-1.262a4 4 0 0 0 1.343-.886L17.5 5.501a2.121 2.121 0 0 0-3-3L3.58 13.419a4 4 0 0 0-.885 1.343Z" />
                </svg>
                更新
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>